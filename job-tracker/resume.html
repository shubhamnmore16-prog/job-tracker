<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI JOB Chatbot System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- Airtel Red Theme --- */
        :root {
            --primary-red: #E40000;
            --text-dark: #333333;
            --bg-gray: #f4f6f8;
            --chat-white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #eef2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            flex-direction: column;
        }

        /* Floating Button */
        .fab-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--primary-red);
            color: white;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: none;
            font-size: 28px;
            box-shadow: 0 4px 15px rgba(228, 0, 0, 0.4);
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .fab-btn:hover { transform: scale(1.1); }

        /* Chat Window */
        .chat-widget {
            position: fixed;
            bottom: 110px;
            right: 30px;
            width: 380px;
            height: 600px;
            background-color: var(--chat-white);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        /* Header */
        .chat-header {
            background: linear-gradient(135deg, #E40000 0%, #ff4d4d 100%);
            color: white;
            padding: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .header-title { display: flex; align-items: center; gap: 10px; }
        .bot-icon { background: white; color: var(--primary-red); width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        /* Chat Body */
        .chat-body {
            flex: 1;
            padding: 20px;
            background-color: #fff;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            scrollbar-width: thin;
        }

        /* Messages */
        .msg-row { display: flex; width: 100%; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .msg-bubble {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.5;
            position: relative;
            word-wrap: break-word;
        }
        
        .bot-msg { background-color: #f0f2f5; color: var(--text-dark); border-bottom-left-radius: 2px; }
        .user-msg { background-color: var(--primary-red); color: white; margin-left: auto; border-bottom-right-radius: 2px; }

        /* Links & Buttons in Chat */
        .bot-msg a { color: var(--primary-red); font-weight: bold; text-decoration: none; border-bottom: 1px dashed var(--primary-red); }
        .bot-msg a:hover { border-bottom: 1px solid var(--primary-red); }

        .job-card { background: white; border: 1px solid #eee; border-radius: 12px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); width: 90%; margin-top: 5px; }
        .apply-btn { background: white; border: 1px solid var(--primary-red); color: var(--primary-red); padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 8px; transition: 0.2s; }
        .apply-btn:hover { background: var(--primary-red); color: white; }

        /* Chips */
        .chips-container { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 5px; }
        .chip { background: white; border: 1px solid #ccc; color: #333; padding: 8px 15px; border-radius: 20px; font-size: 13px; cursor: pointer; transition: 0.2s; }
        .chip:hover { border-color: var(--primary-red); color: var(--primary-red); background: #fff5f5; }

        /* Footer */
        .chat-footer { padding: 12px 15px; border-top: 1px solid #eee; background: white; display: flex; align-items: center; gap: 10px; }
        .icon-btn { color: #666; font-size: 20px; cursor: pointer; padding: 5px; transition: 0.2s; }
        .icon-btn:hover { color: var(--primary-red); }
        .chat-input { flex: 1; padding: 12px 15px; border: 1px solid #ddd; border-radius: 25px; outline: none; transition: 0.3s; }
        .chat-input:focus { border-color: var(--primary-red); }
        .send-icon { color: var(--primary-red); font-size: 22px; cursor: pointer; padding: 5px; }

        /* Typing Animation */
        .typing { display: none; margin-left: 10px; padding: 10px; background: #f0f2f5; border-radius: 20px; width: fit-content; }
        .typing span { display: inline-block; width: 6px; height: 6px; background: #bbb; border-radius: 50%; animation: bounce 1.4s infinite; margin: 0 2px; }
        @keyframes bounce { 0%, 100% { transform: scale(0); } 50% { transform: scale(1); } }
    </style>
</head>
<body>

    <h2 style="color:#333;">AI JOB Tracking System</h2>
    <p>Click the Red Chat Icon below to start.</p>

    <button class="fab-btn" onclick="toggleChat()">
        <i class="fas fa-comment-dots"></i>
    </button>

    <div class="chat-widget" id="chatWidget">
        <div class="chat-header">
            <div class="header-title">
                <div class="bot-icon"><i class="fas fa-robot"></i></div>
                <span>AI JOB Chatbot</span>
            </div>
            <i class="fas fa-times" onclick="toggleChat()" style="cursor: pointer; font-size: 20px;"></i>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="msg-row">
                <div class="msg-bubble bot-msg">
                    Hi! üëã Welcome to <b>AI JOB Chatbot</b>.<br>
                    I can help you manage your applications, analyze resumes, or find new jobs.
                </div>
            </div>

            <div class="chips-container">
                <div class="chip" onclick="handleChip('What is Job Tracking System?')">‚ùì What is System?</div>
                <div class="chip" onclick="handleChip('Find Latest Jobs')">üî• Find Jobs</div>
                <div class="chip" onclick="handleChip('Upload Resume')">üìÑ Check Resume</div>
            </div>

            <div class="typing" id="typing"><span></span><span></span><span></span></div>
        </div>

        <div class="chat-footer">
            <input type="file" id="resumeUpload" hidden onchange="handleFile(event)">
            <div class="icon-btn" onclick="document.getElementById('resumeUpload').click()" title="Upload Resume">
                <i class="fas fa-paperclip"></i>
            </div>
            <input type="text" id="userIn" class="chat-input" placeholder="Type a message..." onkeypress="handleEnter(event)">
            <div class="send-icon" onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </div>
        </div>
    </div>

    <script>
        const chatWidget = document.getElementById('chatWidget');
        const chatBody = document.getElementById('chatBody');
        const typing = document.getElementById('typing');

        // ============================================================
        // 1. ADVANCED KNOWLEDGE BASE (Technical + Small Talk)
        // ============================================================
        const knowledgeBase = [
            // --- Small Talk Fixes (Solves the "okk/thanks" error) ---
            { keys: ["hi", "hello", "hey", "namaste"], answer: "Hello! üëã I am here to help you get hired. Ask me anything!" },
            { keys: ["ok", "okk", "okay", "done", "alright", "great", "nice", "good"], answer: "Awesome! üëç Is there anything else you need help with? Maybe **Find Jobs**?" },
            { keys: ["thank", "thx", "thanks"], answer: "You're most welcome! üòä Happy to help." },
            { keys: ["bye", "goodbye"], answer: "Goodbye! üëã Good luck with your job search." },
            { keys: ["yes", "yeah", "yep"], answer: "Great! Tell me what to do next. Search jobs? üîç" },
            { keys: ["no", "nope"], answer: "Alright. If you have questions later, just ask!" },

            // --- Technical Knowledge Base (Your 15 Questions) ---
            { keys: ["what is", "tracking system"], answer: "<b>Job Tracking System</b> helps users track job applications, application status, interview dates, follow ups, reminders, and AI insights." },
            { keys: ["add", "new job"], answer: "To add a job: Go to <b>Add Job</b> ‚Üí Enter company name, job role, link, applied date, upload resume, and notes ‚Üí Click <b>Save</b>." },
            { keys: ["status", "types"], answer: "Available Job Statuses: <br>Applied, Shortlisted, Interview Scheduled, Interview Completed, Selected, Rejected, On Hold, Follow-Up Pending." },
            { keys: ["ai help", "feature"], answer: "<b>AI Features:</b> Suggests resume improvements, predicts interview chances, sends reminders, summarizes job descriptions, and creates follow-up emails." },
            { keys: ["reminder", "alarm"], answer: "AI will remind you based on date & time. You can also set custom reminders for follow-ups." },
            { keys: ["resume analysis", "missing skills"], answer: "AI detects missing skills, grammar errors, ATS score, and role match score from your resume." },
            { keys: ["track interview", "rounds"], answer: "Each job shows Round 1, Round 2, HR Round, etc. You can update the status for each round separately." },
            { keys: ["email", "follow-up", "write"], answer: "Yes, AI can auto-generate professional follow-up emails after interviews or job applications." },
            { keys: ["upload", "document"], answer: "You can upload resumes, cover letters, certificates, and job description PDFs." },
            { keys: ["dashboard", "customize"], answer: "Yes, users can filter jobs by status, company, role, applied date, match score, or priority level." },
            { keys: ["recommend", "suggest job"], answer: "AI can analyze your resume + preferred roles and recommend matching jobs automatically." },
            { keys: ["delete", "archive", "remove"], answer: "Open job ‚Üí Click Menu ‚Üí Archive or Delete. Archived jobs stay saved but hidden from the main dashboard." },
            { keys: ["notification", "alert"], answer: "Yes, AI sends push/email notifications for reminders, follow-ups, new job matches, and interview alerts." },
            { keys: ["export", "pdf", "csv"], answer: "Yes, you can export your data in PDF, CSV, or JSON format." },
            { keys: ["match score", "calculate", "ats"], answer: "AI compares your skills, experience, and keywords with the job description to calculate an ATS-based score." }
        ];

        // ============================================================
        // 2. CORE FUNCTIONS
        // ============================================================
        
        function toggleChat() { 
            chatWidget.style.display = (chatWidget.style.display === 'flex') ? 'none' : 'flex'; 
        }

        function handleEnter(e) { if(e.key === 'Enter') sendMessage(); }

        function handleChip(text) { 
            if(text === 'Find Latest Jobs') { document.getElementById('userIn').value = "find jobs"; sendMessage(); }
            else if(text === 'Upload Resume') { document.getElementById('resumeUpload').click(); }
            else { document.getElementById('userIn').value = text; sendMessage(); }
        }

        function sendMessage() {
            const input = document.getElementById('userIn');
            const txt = input.value.trim();
            if(!txt) return;

            addMsg(txt, 'user');
            input.value = '';
            showTyping();
            
            setTimeout(() => {
                hideTyping();
                botResponse(txt);
            }, 800);
        }

        // ============================================================
        // 3. AI LOGIC (BRAIN)
        // ============================================================
        function botResponse(input) {
            input = input.toLowerCase();

            // A. Check Knowledge Base First
            let foundAnswer = false;
            for (let item of knowledgeBase) {
                if (item.keys.some(k => input.includes(k))) {
                    addMsg(item.answer, 'bot');
                    foundAnswer = true;
                    break;
                }
            }

            // B. If Not in KB, Check Special Features
            if (!foundAnswer) {
                // Job Search Integration
                if (input.includes('job') && (input.includes('find') || input.includes('search') || input.includes('shine') || input.includes('latest'))) {
                    addMsg(`I found <b>47,325+ Active Jobs</b> matching your profile on Shine.com.<br><br>üëâ <a href="https://www.shine.com/job-search/test-jobs" target="_blank">Click here to Apply Now</a>`, 'bot');
                    
                    // Show Dummy Cards
                    setTimeout(() => {
                        createJobCard("Software Engineer", "Google India", "https://www.shine.com/job-search/test-jobs");
                        createJobCard("Data Analyst", "Airtel X Labs", "https://www.shine.com/job-search/test-jobs");
                    }, 500);
                } 
                // Resume Logic
                else if (input.includes('resume') || input.includes('cv')) {
                     addMsg("To analyze your resume, please click the paperclip icon üìé below and select your file.", 'bot');
                }
                // Fallback (Friendly Error Handling)
                else {
                    addMsg("I am listening! ü§ñ I didn't quite catch that.<br>You can ask me:<br>‚Ä¢ <b>'How to add a job?'</b><br>‚Ä¢ <b>'Show me latest jobs'</b><br>‚Ä¢ Or <b>Upload Resume</b>.", 'bot');
                }
            }
        }

        // ============================================================
        // 4. FILE UPLOAD & HELPER FUNCTIONS
        // ============================================================
        function handleFile(e) {
            const file = e.target.files[0];
            if(!file) return;
            addMsg(`üìÑ Uploading: ${file.name}...`, 'user');
            showTyping();
            setTimeout(() => { 
                hideTyping(); 
                addMsg(`‚úÖ <b>Analysis Complete!</b><br><b>AI Score: 88/100</b><br>Great match for 'Web Developer' roles.`, 'bot'); 
            }, 2000);
        }

        function addMsg(html, type) {
            const div = document.createElement('div'); div.className = 'msg-row';
            const bubble = document.createElement('div'); bubble.className = `msg-bubble ${type === 'user' ? 'user-msg' : 'bot-msg'}`;
            bubble.innerHTML = html;
            div.appendChild(bubble); 
            chatBody.insertBefore(div, typing); 
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function createJobCard(role, company, link) {
            const div = document.createElement('div'); div.className = 'job-card';
            div.innerHTML = `<div style="font-weight:bold; color:#333;">${role}</div><div style="color:#666;font-size:12px;margin-bottom:5px;">${company}</div><button class="apply-btn" onclick="window.open('${link}','_blank')">Apply on Shine</button>`;
            chatBody.insertBefore(div, typing); 
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        function showTyping() { typing.style.display = 'block'; chatBody.scrollTop = chatBody.scrollHeight; }
        function hideTyping() { typing.style.display = 'none'; }
    </script>
</body>
</html>